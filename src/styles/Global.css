/* src/styles/Global.css */

/* --------------------- Tokens (MUST) --------------------- */
:root {
  /* 8pt grid */
  --space-8: 0.5rem; /* 8px相当（基準） */
  --space-1: calc(var(--space-8) / 8);

  --radius-12: calc(var(--space-8) * 1.5);
  --radius-16: calc(var(--space-8) * 2);

  --line-1: var(--space-1);

  --motion-200: 200ms;

  --shadow-1: 0 calc(var(--space-1) * 2) calc(var(--space-8) * 1)
    color-mix(in oklab, #000 10%, transparent);
  --shadow-2: 0 calc(var(--space-1) * 3) calc(var(--space-8) * 1.5)
    color-mix(in oklab, #000 14%, transparent);

  /* colors */
  --color-bg: #ffffff;
  --color-text: #0b0b0f;
  --color-surface: #ffffff;
  --color-surface-2: #f3f4f6;
  --color-surface-3: #e7e9ee;
  --color-border: color-mix(in oklab, var(--color-text) 12%, transparent);
  --color-ink: #0b0b0f;
  --color-shadow: #000000;

  --color-success-surface: #34c759;
  --color-danger-surface: #ff3b30;
  --color-warning-surface: #ffcc00;
  --color-info-surface: #0a84ff;

  --focus-ring: var(--color-info-surface);

  /* backward-compat (あなたの既存CSSが --bg / --text を参照するため保持) */
  --bg: var(--color-bg);
  --text: var(--color-text);

  /* --------------------- Avatar palette (SVG fill/stroke -> CSS vars) --------------------- */
  /* cat-wizard.svg などで検出された色（必要なら増やしてOK） */
  --color-avatar-fbf1e7: #fbf1e7;
  --color-avatar-e8c9a2: #e8c9a2;
  --color-avatar-e4b193: #e4b193;
  --color-avatar-acb557: #acb557;
  --color-avatar-5c65a5: #5c65a5;
  --color-avatar-67a134: #67a134;
  --color-avatar-b44339: #b44339;
  --color-avatar-615b5a: #615b5a;
  --color-avatar-644c35: #644c35;
  --color-avatar-573025: #573025;
  --color-avatar-292725: #292725;
}

[data-theme="dark"] {
  --color-bg: #0b0b0f;
  --color-text: #f5f7ff;
  --color-surface: #14151b;
  --color-surface-2: #1b1c24;
  --color-surface-3: #242635;
  --color-border: color-mix(in oklab, var(--color-text) 16%, transparent);
  --color-shadow: #000000;

  --bg: var(--color-bg);
  --text: var(--color-text);

  /* avatar palette（暗色テーマでも同じ色を使うならこのままでOK）
     もし暗くしたいなら、ここで上書きする */
  --color-avatar-fbf1e7: #fbf1e7;
  --color-avatar-e8c9a2: #e8c9a2;
  --color-avatar-e4b193: #e4b193;
  --color-avatar-acb557: #acb557;
  --color-avatar-5c65a5: #5c65a5;
  --color-avatar-67a134: #67a134;
  --color-avatar-b44339: #b44339;
  --color-avatar-615b5a: #615b5a;
  --color-avatar-644c35: #644c35;
  --color-avatar-573025: #573025;
  --color-avatar-292725: #292725;
}

/* --------------------- Reset & Base --------------------- */
*,
*::before,
*::after {
  box-sizing: border-box;
}

html,
body {
  height: 100%;
  min-height: 100%;
}

html {
  -webkit-text-size-adjust: 100%;
  color-scheme: light dark;
}

body {
  margin: 0;
  background-color: var(--bg);
  color: var(--text);
  font-family: var(
    --font-ja-sans,
    system-ui,
    -apple-system,
    "Noto Sans JP",
    "Roboto",
    sans-serif
  );
  line-height: 1.6;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;

  overflow-x: hidden;

  /* ✅ safe-area top は Layout/Header 側で処理（ここでは入れない） */
  padding-left: max(0px, env(safe-area-inset-left));
  padding-right: max(0px, env(safe-area-inset-right));

  /* 画面全体はスクロールさせない（中身スクロールは Layout で） */
  overflow-y: hidden;
}

[hidden],
.app-loading[hidden] {
  display: none !important;
}

/* root を固定して Layout 内だけスクロール */
#root {
  height: 100dvh;
  min-height: 100dvh;
  overflow: hidden;
}

/* images */
img {
  max-width: 100%;
  height: auto;
  display: block;
  border-radius: var(--radius-12);
}

/* a11y focus（Themeの focus-ring を使用） */
:where(button, [role="button"], a, input, select, textarea):focus-visible {
  outline: none;
  box-shadow: 0 0 0 calc(var(--line-1) * 3)
    color-mix(in oklab, var(--focus-ring) 55%, transparent);
  border-radius: var(--radius-12);
}

@media (prefers-reduced-motion: reduce) {
  * {
    transition: none !important;
    animation: none !important;
  }
}