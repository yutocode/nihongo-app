/* src/styles/Layout.css */

/* Header / BottomNav / Ad の高さを一元管理 */
:root {
  --layout-header-h: 64px;        /* Header の実高さ */
  --layout-bottom-h: 72px;        /* BottomNav の高さ（Theme の --bn-height と合わせる） */
  --layout-ad-banner-h: 56px;     /* AdMob バナー想定の高さ（だいたい 50〜60px） */
}

/* アプリ全体の外枠（全ページ共通） */
.app-shell {
  height: 100%;
  min-height: 100dvh;
  background: var(--color-bg, var(--bg));
  color: var(--color-text, var(--text));
  box-sizing: border-box;

  /* ヘッダー分だけ上に余白をあける（少し下げたいので +8px） */
  padding-top: calc(var(--layout-header-h) + 8px);

  /* 中身を縦に並べて、真ん中だけスクロールさせる */
  display: flex;
  flex-direction: column;

  /* 黒いプレートを敷くために relative にしておく */
  position: relative;
}

/* 画面の一番下をまるごと BottomNav と同じ色で塗る黒い板 */
.app-shell::before {
  content: "";
  position: fixed;
  left: 0;
  right: 0;
  bottom: 0;

  /* BottomNav + Ad バナー + セーフエリアぶん */
  height: calc(
    var(--layout-bottom-h)
    + var(--layout-ad-banner-h)
    + env(safe-area-inset-bottom, 0px)
  );

  background: var(
    --color-bottom-nav-shell-bg,
    var(--color-bottom-nav-bg, #05060a)
  );

  /* ★ここがポイント：コンテンツ(z=10)より上、BottomNav(z=40)より下 */
  z-index: 30;

  /* タップは下に通す */
  pointer-events: none;
}

/* 固定ヘッダーのラッパー */
.app-shell-header {
  position: fixed;
  inset-inline: 0;
  top: 8px; /* 画面の一番上から 8px 下げる */
  height: var(--layout-header-h);
  z-index: 40;
}

/* メインコンテンツ：ここ「だけ」スクロールさせる */
.app-content {
  flex: 1 1 auto;
  min-height: 0;
  max-width: 1100px;
  width: 100%;
  margin: 0 auto;

  /*
    通常ページ用：
    BottomNav + Ad バナー + 余白 16px + セーフエリアぶん
  */
  padding-bottom: calc(
    var(--layout-bottom-h)
    + var(--layout-ad-banner-h)
    + 16px
    + env(safe-area-inset-bottom, 0px)
  );

  overflow-y: auto;
  -webkit-overflow-scrolling: touch;

  /* 中身は普通に白背景のまま */
  background: var(--color-bg, var(--bg));
  position: relative;
  z-index: 10;
}

/* 固定ボトムナビのラッパー */
.app-shell-bottom {
  position: fixed;
  inset-inline: 0;

  /*
    AdMob バナーが最下部に来る前提で、
    BottomNav はその上に 56px 浮かせて配置
  */
  bottom: var(--layout-ad-banner-h);

  height: calc(
    var(--layout-bottom-h) + env(safe-area-inset-bottom, 0px)
  );
  z-index: 40;

  display: flex;
  justify-content: center;
  align-items: flex-end;

  /* 黒い板は ::before が塗っているのでここは透明でOK */
  background: transparent;
}

/* 中の BottomNav 本体（クリック可） */
.app-shell-bottom > * {
  pointer-events: auto;
  width: 100%;
  max-width: 480px;
}

/* =========================================================
   （必要なら）Ad デバッグ用オーバーレイ
   app-shell に app-shell--ad-debug を付けると、
   下のバナーエリアを線で表示
   ========================================================= */
.app-shell.app-shell--ad-debug::after {
  content: "AD BANNER AREA";
  position: fixed;
  left: 0;
  right: 0;
  bottom: 0;
  height: var(--layout-ad-banner-h);
  background: rgba(255, 255, 0, 0.06);
  border-top: 1px dashed rgba(255, 220, 0, 0.9);
  font-size: 10px;
  text-align: center;
  line-height: var(--layout-ad-banner-h);
  pointer-events: none;
  z-index: 41; /* BottomNav(40) より少し上に出したいとき用 */
}