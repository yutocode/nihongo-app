/* src/styles/Layout.css */

/* ✅ iOSで “overflow-y:auto が効かない” を防ぐため高さを確定 */
html,
body,
#root {
  height: 100%;
}

/* Header / BottomNav / Ad の高さを一元管理 */
:root {
  /* ✅ ここを“総高さ”として統一して使う */
  --layout-header-total-h: calc(
    var(--layout-header-h) + env(safe-area-inset-top, 0)
  );

  --layout-ad-banner-h: calc(var(--space-2) * 7); /* 56px相当 */
}

/* アプリ全体の外枠（全ページ共通） */
.app-shell {
  height: 100dvh;
  min-height: 100dvh;
  background: var(--color-bg, var(--bg));
  color: var(--color-text, var(--text));
  box-sizing: border-box;

  /* ✅ 固定ヘッダー分を“完全一致”で確保 */
  padding-top: var(--layout-header-total-h);

  display: flex;
  flex-direction: column;
  position: relative;

  /* ✅ スクロールは .app-content だけに担当させる */
  overflow: hidden;
}

/* 画面の一番下をまるごと BottomNav と同じ色で塗る黒い板 */
.app-shell::before {
  content: "";
  position: fixed;
  left: 0;
  right: 0;
  bottom: 0;

  height: calc(
    var(--layout-bottom-h) + var(--layout-ad-banner-h) +
      env(safe-area-inset-bottom, 0)
  );

  background: var(--color-bottom-nav-shell-bg, var(--color-bottom-nav-bg));
  z-index: 30;
  pointer-events: none;
}

/* 固定ヘッダーのラッパー（黒背景はここ1枚だけ） */
.app-shell-header {
  position: fixed;
  inset-inline: 0;
  top: 0;

  height: var(--layout-header-total-h);
  padding-top: env(safe-area-inset-top, 0);

  background: var(--color-header-bg);
  z-index: 40;

  /* ✅ 二重影の原因になるので付けない */
  box-shadow: none;
}

/* メインコンテンツ：ここだけスクロール */
.app-content {
  flex: 1 1 auto;
  min-height: 0;
  max-width: 1100px;
  width: 100%;
  margin: 0 auto;

  padding-bottom: calc(
    var(--layout-bottom-h) + var(--layout-ad-banner-h) + var(--space-4) +
      env(safe-area-inset-bottom, 0)
  );

  /* ✅ “ヘッダー直下が詰まりすぎ”を防ぐ（ちょい下げ） */
  padding-top: var(--space-2);

  overflow-y: auto;
  -webkit-overflow-scrolling: touch;

  background: var(--color-bg, var(--bg));
  position: relative;
  z-index: 10;
}

/* 固定ボトムナビのラッパー */
.app-shell-bottom {
  position: fixed;
  inset-inline: 0;
  bottom: var(--layout-ad-banner-h);

  height: calc(var(--layout-bottom-h) + env(safe-area-inset-bottom, 0));
  z-index: 40;

  display: flex;
  justify-content: center;
  align-items: flex-end;

  background: transparent;
}

/* 中の BottomNav 本体（クリック可） */
.app-shell-bottom > * {
  pointer-events: auto;
  width: 100%;
  max-width: 480px;
}